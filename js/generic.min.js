/*! generic 2015-10-05 */
"use strict";Array.prototype.repeat=function(a,b){for(;b;)return this[--b]=a,this};var GApp=angular.module("GApp",["ngRoute","ngAnimate","ngAria","ngMaterial","ngSanitize","pascalprecht.translate","ngCookies","smoothScroll","ng.deviceDetector","GDirectives"]);GApp.constant("CONSTANTS",{TOP_LEVEL_MODULE_PATH:"views/content/",ICON_PATH:"views/icons/",USE_ALT_VIDEO_SERVER:!1,ALT_VIDEO_PATH:"",CROP_MIN_WIDTH:1281,GIF_MAX_WIDTH:768,MODULE_NAME_ARRAY:["intro","Context","Timeline","Collection","Provenance","Archival Process","About"],DICTIONARY_NAME:"json/freetext_dictionary.json"}),GApp.config(["$routeProvider",function(a){a.when("/:lingo/:anchor?",{templateUrl:function(a){return"views/content/"+a.lingo+"/overview.html"},controller:"IndexCtrl"}),a.otherwise({redirectTo:"/en"})}]),GApp.config(["$mdGestureProvider",function(a){a.skipClickHijack()}]),GApp.config(["$translateProvider",function(a){a.useSanitizeValueStrategy("sanitizeParameters"),a.useLocalStorage(),a.useStaticFilesLoader({prefix:"json/languages/",suffix:".json"}),a.preferredLanguage("no")}]),GApp.config(["$mdThemingProvider",function(a){a.theme("main").primaryPalette("indigo"),a.setDefaultTheme("main")}]),GApp.config(["$httpProvider",function(a){a.defaults.withCredentials=!1,a.defaults.headers.common.Accept="application/json",a.defaults.headers.common["Content-Type"]="application/json"}]),GApp.controller("IndexCtrl",["$scope","$translate","$mdSidenav","$location","$routeParams","$timeout","$window","DataService","smoothScroll","CONSTANTS",function(a,b,c,d,e,f,g,h,i,j){a.modules=j.MODULE_NAME_ARRAY,a.currentLanguage=h.applicationVariable.currentLanguage,a.dymanicTheme="default",a.currentModule="",a.searchWord="",a.searchResults=[],a.uid="";var k=!1,l="";a.$on("$viewContentLoaded",function(){""!==l&&f(function(){a.seekToAnchor(l)},500)}),a.$on("$routeChangeSuccess",function(b,c){a.closeMenu(),g.scrollTo(0,0),c.params.anchor&&(l=h.applicationVariable.anchorToSeek=c.params.anchor),c.params.lingo!==a.currentLanguage&&a.changeLanguage(c.params.lingo)}),a.openMenu=function(){c("right").open(),k=!0},a.closeMenu=function(){k&&c("right").close(),k=!1;var a=angular.element(document.querySelector("#content"));"undefined"!=typeof a[0]&&a[0].focus()},a.changeLanguage=function(c){"undefined"==typeof c&&(c="en"),a.displayLanguage=a.currentLanguage=h.applicationVariable.currentLanguage=c,b.use(a.currentLanguage),d.path(c)},a.playVideo=function(a){var b=angular.element("video")[a];b.paused?b.play():b.pause()},a.submit=function(){a.searchWord&&(a.searchResults=h.getDictionaryValues(a.searchWord.toLowerCase()))},a.seekToAnchor=function(b){l=h.applicationVariable.anchorToSeek="";var c=document.getElementById(b);i(c,{duration:700,easing:"easeInQuad"}),f(function(){a.$broadcast("slideToggle",b)},1e3)},a.seek=function(b){b[0]&&b[1]&&b[2]&&(a.closeMenu(),h.applicationVariable.currentModule&&h.applicationVariable.currentModule===b[1]&&a.currentLanguage&&a.currentLanguage===b[2]?a.seekToAnchor("s"+b[0]):d.path("/"+b[1]+"/"+b[2]+"/"+b[0]))},a.orderItemByIdFunction=function(a){return parseInt(a.id)},a.orderItemByKandidatnrFunction=function(a){return parseInt(a.candidate_number)}}]),GApp.service("DataService",["$http","CONSTANTS",function(a,b){var c,d={currentModule:"1",currentLanguage:"no",anchorToSeek:""},e=function(a){for(var b,c,d=a.length;0!==d;)c=Math.floor(Math.random()*d),d-=1,b=a[d],a[d]=a[c],a[c]=b;return a},f=function(b,c,d){return a({method:"post",url:d,data:{action:b,data:c},headers:{"Content-Type":"application/x-www-form-urlencoded"}})};return a.get(b.DICTIONARY_NAME).then(function(a){c=a.data}),{serverRequest:f,getDictionary:function(){return c},getDictionaryKeys:function(){return Object.keys(c)},getDictionaryValues:function(a){return c[a]},shuffle:e,applicationVariable:d}}]);var GDirectives=angular.module("GDirectives",[]);GDirectives.directive("slideable",function(){return{restrict:"C",compile:function(a){var b=a.html();return a.html('<div class="slideable_content" style="margin:0 !important; padding:0 !important">'+b+"</div>"),function(a,b,c){c.duration="undefined"==typeof c.duration?"1s":c.duration,c.easing="undefined"==typeof c.easing?"ease-in-out":c.easing,c.delay="undefined"==typeof c.delay?"1s":c.delay,b.css({overflow:"hidden",height:"0px",padding:"0",transitionProperty:"height, padding",transitionDuration:c.duration,transitionTimingFunction:c.easing,transitionDelay:c.delay})}}}}),GDirectives.directive("sliderToggle",["$timeout","$window",function(a,b){return{restrict:"A",link:function(c,d,e){function f(){g||(g=document.querySelector(e.sliderToggle)),h||(h=g.querySelector(".slideable_content"));var c=angular.element(g);if(e.expanded)i||(j&&c.removeClass("sectionDetail_open"),g.style.height="0px",g.style.padding="0");else{var d=h.clientHeight;if(g.style.height=d+"px",g.style.padding="10px 0",j){var f=b.innerWidth;f>=1280?g.style.padding="50px 43% 50px 7%":f>=1024?g.style.padding="50px 30% 50px 7%":f>=768?g.style.padding="50px 15% 50px 7%":f>=480?g.style.padding="50px 5% 50px 5%":f>=320&&(g.style.padding="50px 7% 50px 7%"),a(function(){g.style.height="100%",g.style.padding=null,c.addClass("sectionDetail_open")},2e3)}}e.expanded=!e.expanded}e.expanded=!1;var g,h,i="true"===e.preventClose,j="true"===e.sectionDetailArea;"true"===e.clickToActivate&&d.off("click").bind("click",f),c.$on("slideToggle",function(a,b){b===e.sid&&f()})}}}]),GDirectives.directive("ngEnter",["$timeout",function(a){return function(b,c,d){c.bind("keydown keypress",function(c){13===c.which&&(a(function(){b.$eval(d.ngEnter)}),c.preventDefault())})}}]),GDirectives.directive("sectionBox",["$window","$document","$route","$sce","$timeout","smoothScroll","CONSTANTS",function(a,b,c,d,e,f,g){var h=function(b,h,i){var j,k=!0,l=!1,m=c.current.params.module,n=g.TOP_LEVEL_MODULE_PATH+"img/";"undefined"==typeof b.videosrc&&(b.videosrc=""),"undefined"==typeof b.posterSrc&&(b.posterSrc=""),"undefined"==typeof b.gifSrc&&(b.gifSrc=""),b.slideId=i.id+"_slide",b.showVideo=!1,b.noPreloadGifSrcPath=n+b.posterSrc,b.videoSrcPath=n+b.videoSrc,b.imageSrcPath=n+b.posterSrc,b.detailActive=!1,b.includeSrcPath=g.TOP_LEVEL_MODULE_PATH+c.current.params.lingo+"/"+i.id+".html",b.slideToggle=function(){var a=document.getElementById(b.slideId),c=a.querySelector(".content-selector"),d=c.offsetHeight+"px";b.detailActive?(a.style.height=d,e(function(){a.style.height="0",""!==b.videoSrc&&(b.showVideo=!1,j.style.height="0")},0)):(""!==b.videoSrc&&(j.style.height="auto"),a.style.height=d,e(function(){a.style.height="auto"},1e3)),b.detailActive=!b.detailActive,o()},b.$on("$routeChangeSuccess",function(){b.videoPath=g.TOP_LEVEL_MODULE_PATH+m+"/img/",b.noPreloadGifSrc=n+b.posterSrc,b.imageSrc="url("+(n+b.posterSrc)+")",o()});var o=function(){b.detailActive?b.overlayText=b.textOpen:b.overlayText=b.textClosed};b.trustResource=function(a){return d.trustAsResourceUrl(a)},b.activate=function(){b.slideToggle(),k&&e(function(){f(h[0],{duration:500})},100),""!==b.gifSrc&&"false"===b.forceIphoneVideo&&a.innerWidth<g.GIF_MAX_WIDTH?b.noPreloadGifSrcPath=n+b.gifSrc:""!==b.videoSrc&&(b.showVideo=!0,l?(j.pause(),j.currentTime=0,l=!1):(j.play(),l=!0))},e(function(){o(),j=h.find("video")[0]})};return{restrict:"E",replace:!0,scope:{posterSrc:"@",videoSrc:"@",gifSrc:"@",textClosed:"@",textOpen:"@",icon:"@",forceIphoneVideo:"@"},link:h,templateUrl:"views/templates/sectionbox.html"}}]),GDirectives.directive("readmore",["$timeout",function(a){var b=function(b){var c,d,e=!1;b.addlowerborder=!0,b.type&&"task"===b.type?c=d="views/icons/widgets/oppgave/704-compose@2x.svg":(d="views/icons/body/readmore/remove.svg",c="views/icons/body/readmore/readmore.svg"),b.readmoreImageSrc=c,b.toggleIcon=function(){a(function(){e=!e,e?(b.readmoreImageSrc=d,b.addlowerborder=!1):(b.readmoreImageSrc=c,b.addlowerborder=!0)},1e3)}};return{templateUrl:"views/templates/readmore.html",restrict:"A",transclude:!0,link:b,scope:{rid:"@",title:"@",type:"@"}}}]),GDirectives.directive("quickquestion",[function(){var a=function(a){a.answerState=!1,a.answer=function(){a.answerState=!a.answerState}};return{templateUrl:"views/templates/quickquestion.html",restrict:"A",transclude:!0,link:a,scope:{gQuestion:"@",gAnswer:"@"}}}]),GDirectives.directive("greybox",[function(){var a=function(a){a.icon="",a.type&&("funfact"===a.type?a.icon="views/icons/body/greybox/870-smile@2x.svg":"warning"===a.type?a.icon="views/icons/body/greybox/791-warning@2x.svg":"story"===a.type?a.icon="views/icons/body/greybox/961-book-32@2x.svg":"quote"===a.type&&(a.icon="views/icons/body/greybox/quotation.svg"))};return{templateUrl:"views/templates/greybox.html",link:a,restrict:"A",transclude:!0,scope:{type:"@"}}}]),GDirectives.directive("quotebox",[function(){return{templateUrl:"views/templates/quotebox.html",restrict:"A",transclude:!0,scope:{type:"@"}}}]),GDirectives.directive("glink",[function(){var a=function(a){a.ipath="views/icons/body/702-share.svg"};return{template:'<a class="glink" href="{{href}}" target="_blank"><ng-transclude></ng-transclude><ng-include src="ipath"></ng-include></a>',restrict:"E",transclude:!0,link:a,scope:{href:"@"}}}]),GDirectives.directive("quiz",["$http","$route","$timeout","$sce",function(a,b,c,d){var e=function(b){var e;b.filePath="",b.showLoginButton=!1,b.showAlreadyPassedDownloadButton=!1,b.showLanguageSwitch=!1,b.inSecondLanguage=!1,b.incorrectAnswers=[],b.quizpoll={},"undefined"==typeof b.hShuffleQuestions&&(b.hShuffleQuestions=!1),b.trustResource=function(a){return d.trustAsHtml(a)},b.chooseLanguage=function(a){b.inSecondLanguage=a,b.reload(!0)},b.reload=function(){a({method:"GET",url:"json/quizpolls.json"}).then(function(a){b.quizpoll=a.data.quizpolls[b.qid],e=b.quizpoll,b.state="begin",b.type="radio",b.totalPages=e.questions.length,b.radioTempData={state:-1},b.title=e.title||"(placeholder title)",b.intro=e.intro,b.percentScore=0,b.diploma_link="",b.passPercent=80,b.summarypass=e.summarypass,b.summaryfail=e.summaryfail,b.image_url=e.image_url,b.currentQuestion={},b.data={answers:[],student_id:"",score:0},b.filePath="img/quiz/"})},b.check=function(a){if("question"===b.state){if("checkbox"===b.currentQuestion.type){b.currentData[a]=!b.currentData[a],b.resultDisabled=!0;for(var c=0;c<b.currentData.length;c++)b.currentData[c]&&(b.resultDisabled=!1)}else if("radio"===b.currentQuestion.type){b.radioTempData.state=a;for(var d=0;d<b.currentData.length;d++)b.currentData[d]=!1;b.currentData[a]=!0,b.resultDisabled=!1}b.answer()}},b.clickStart=function(){b.start()},b.start=function(){b.pageIndex=-1,b.currentData=null,b.responseStatus="",b.resultDisabled=!0,b.maxscore=0,b.data.score=0,b.data.answers=[],e.questions.forEach(function(a){var c=[].repeat(!1,a.answers.length);b.data.answers.push(c);for(var d=0;d<a.answers.length;d++)a.answers[d].correct&&b.maxscore++}),b.next()},b.answer=function(){if("radio"===b.currentQuestion.type)b.currentQuestion.answers[b.radioTempData.state].correct?b.data.score++:b.incorrectAnswers.push(b.currentQuestion.text);else if("checkbox"===b.currentQuestion.type)for(var a=0;a<b.currentQuestion.answers.length;a++)b.currentQuestion.answers[a].correct&&b.currentData[a]?b.data.score++:b.currentQuestion.answers[a].correct===!1&&b.currentData[a]===!0?(b.data.score--,b.incorrectAnswers.push(b.currentQuestion.text)):b.incorrectAnswers.push(b.currentQuestion.text);var d=Math.floor(b.data.score/b.maxscore*100);b.percentScore=0>d?0:d,c(function(){b.state="result"},0)},b.next=function(){b.state="question",b.pageIndex++,b.resultDisabled=!0,b.radioTempData.state=-1,b.pageIndex===b.totalPages?b.state="end":(b.currentData=b.data.answers[b.pageIndex],b.currentQuestion=e.questions[b.pageIndex],b.type=b.currentQuestion.type,b.image_url=""!==b.currentQuestion.image_url?b.filePath+b.currentQuestion.image_url:"")},b.reload(!1)};return{restrict:"E",link:e,templateUrl:"views/templates/quiz-template.html",scope:{qid:"@"}}}]);